# enter the data as vector
frac=c(30,75,79,80,80,105,126,138,149,179,179,191,
223,232,232,236,240,242,245,247,254,274,384,470)
# to sort the data
frac=sort(frac) #not necessary
### LOCATION ###
# mean
mean(frac)
# median
median(frac)
# mode
freq=table(frac) # find frequency of observations
which(freq==max(freq))
# 5% trimmed mean
mean(frac, trim=0.05)
help("mean")
# 25th percentiles, type=6 is weighted average
quantile(frac,0.25,type=6)
### SPREAD ###
# variance and standard deviation
var(frac)
sqrt(var(frac)) #standard deviation
sd(frac)
# range
diff(range(frac))
# IQR
IQR(frac,type=6)
Height=c(68, 71, 62, 75, 58, 60, 67, 68, 71, 69, 68, 67, 63, 62, 60, 63, 65, 67, 63, 61)
Esteem=c(4.1, 4.6, 3.8, 4.4, 3.2, 3.1, 3.8, 4.1, 4.3, 3.7, 3.5, 3.2, 3.7, 3.3, 3.4, 4.0, 4.1, 3.8, 3.4, 3.6)
plot(Esteem,Height,pch=19)
abline(lm(Height~Esteem), col="red")
cor(Height,Esteem)
qqplot(placebo,alcohol)
placebo=c(0.90,0.37,1.63,0.83,0.95,0.78,0.86,0.61,0.38,1.97)
alcohol=c(1.46,1.45,1.76,1.44,1.11,3.07,0.98,1.27,2.56,1.32)
T=sum(rank(c(placebo,alcohol))[1:length(placebo)]);T
qqplot(placebo,alcohol)
help(qqplot)
ks.test(placebo,alcohol)
help(ks.test)
pcenter=placebo-mean(placebo)
acenter=alchohol-mean(alcohol)
pcenter=placebo-mean(placebo)
acenter=alchohol-mean(alcohol)
acenter=alcohol-mean(alcohol)
qqplot(pcenter,acenter)
ks.test(pcenter,acenter)
qqplot(pcenter,acenter,main="QQ plot of centered data")
qqplot(pcenter,acenter,main="QQ plot of centered data",ylab="Centered alcohol",xlab="Centered placebo")
abline(c(0,1))
qqplot(pcenter,acenter,main="QQ plot of centered data",ylab="Centered alcohol quantiles",xlab="Centered placebo quantiles")
abline(c(0,1))
ks.test(pcenter,acenter)
pcenter=placebo-mean(placebo)
acenter=alcohol-mean(alcohol)
qqplot(pcenter,acenter,main="QQ plot of centered data",ylab="Centered alcohol quantiles",xlab="Centered placebo quantiles")
abline(c(0,1))
ks.test(pcenter,acenter)
# Normality
#windows(6.5,5.4)
plot(density(re),col='red',ylim=c(0,0.5),xlab="std. residuals",main="Histogram of std residuals")
hist(re,freq=FALSE,border='red',add=TRUE)
plot(function(t)dnorm(t),from=-3,to=3,add=TRUE)
copier=read.csv("http://www.stat.ufl.edu/~athienit/STA4210/Examples/copiers.csv",skip=1,header=TRUE)
plot(copier$Copiers,copier$Time,pch=16,xlab="Quantity",ylab="Time (in minutes)",main="Scatterplot")
reg=lm(Time~Copiers,data=copier)
summary(reg)
anova(reg)
abline(reg)
confint(reg,level=0.95,method="Wald")
predict.lm(reg,se.fit=TRUE,newdata=data.frame(Copiers=5),interval="confidence",level=0.95)
# alternatively
v=vcov(reg);v
sum(coefficients(reg)*c(1,5))+c(-1,1)*qt(0.975,df.residual(reg))*sqrt(v[1,1]+5^2*v[2,2]+2*5*v[1,2])
predict.lm(reg,se.fit=TRUE,newdata=data.frame(Copiers=7),interval="prediction",level=0.95)
### Checking model assumptions
re=rstandard(reg) #standardized residuals
# Normality
#windows(6.5,5.4)
plot(density(re),col='red',ylim=c(0,0.5),xlab="std. residuals",main="Histogram of std residuals")
hist(re,freq=FALSE,border='red',add=TRUE)
plot(function(t)dnorm(t),from=-3,to=3,add=TRUE)
#windows(6.5,5.4)
qqnorm(re,datax=TRUE)
qqline(re,datax=TRUE)
copier=read.csv("C:/Users/demetris/OneDrive - University of Florida/Teaching/STA 6166/STA6166material/copiers.csv",skip=1,header=TRUE)
plot(copier$Copiers,copier$Time,pch=16,xlab="Quantity",ylab="Time (in minutes)",main="Scatterplot")
reg=lm(Time~Copiers,data=copier)
summary(reg)
anova(reg)
abline(reg)
confint(reg,level=0.95,method="Wald")
predict.lm(reg,se.fit=TRUE,newdata=data.frame(Copiers=5),interval="confidence",level=0.95)
# alternatively
v=vcov(reg);v
sum(coefficients(reg)*c(1,5))+c(-1,1)*qt(0.975,df.residual(reg))*sqrt(v[1,1]+5^2*v[2,2]+2*5*v[1,2])
predict.lm(reg,se.fit=TRUE,newdata=data.frame(Copiers=7),interval="prediction",level=0.95)
### Checking model assumptions
re=rstandard(reg) #standardized residuals
### Checking model assumptions
re=rstandard(reg) #standardized residuals
# Normality
#windows(6.5,5.4)
plot(density(re),col='red',ylim=c(0,0.5),xlab="std. residuals",main="Histogram of std residuals")
hist(re,freq=FALSE,border='red',add=TRUE)
plot(function(t)dnorm(t),from=-3,to=3,add=TRUE)
#windows(6.5,5.4)
qqnorm(re,datax=TRUE)
qqline(re,datax=TRUE)
# Normality
#windows(6.5,5.4)
par(mfrow=c(2,1))
plot(density(re),col='red',ylim=c(0,0.5),xlab="std. residuals",main="Histogram of std residuals")
hist(re,freq=FALSE,border='red',add=TRUE)
plot(function(t)dnorm(t),from=-3,to=3,add=TRUE)
#windows(6.5,5.4)
qqnorm(re,datax=TRUE)
qqline(re,datax=TRUE)
# Normality
#windows(6.5,5.4)
par(mfrow=c(1,2))
plot(density(re),col='red',ylim=c(0,0.5),xlab="std. residuals",main="Histogram of std residuals")
hist(re,freq=FALSE,border='red',add=TRUE)
plot(function(t)dnorm(t),from=-3,to=3,add=TRUE)
#windows(6.5,5.4)
qqnorm(re,datax=TRUE)
qqline(re,datax=TRUE)
dat=read.csv("http://www.stat.ufl.edu/~athienit/STA6166/safe_reg.csv",header=TRUE)
attach(dat)
library(car)
scatterplot(y~x1|x2,smooth=FALSE,reg.line=FALSE,data=dat)
reg1=lm(y~x1+x2)
summary(reg1)
coef1=coef(reg1)
curve(coef1[1]+coef1[3]+coef1[2]*x,from=1500,to=10000,add=T,col="red")
curve(coef1[1]+coef1[2]*x,from=1500,to=10000,add=T)
scatterplot(y~x1|x2,smooth=FALSE,reg.line=lm,data=dat)
reg2=lm(y~x1+x2+x1:x2) #same as lm(y~x1+x2+x1*x2) or lm(y~x1*x2)
summary(reg2)
vc=vcov(reg2);round(vc,2)
sum(reg2$coefficients[c(2,4)])+c(1,-1)*qt(0.025,reg2$df.residual)*sqrt(vc[2,2]+vc[4,4]+2*vc[2,4])
dat=read.csv("C:/Users/demetris/OneDrive - University of Florida/Teaching/STA 6166/STA6166material/safe_reg.csv",header=TRUE)
attach(dat)
library(car)
scatterplot(y~x1|x2,smooth=FALSE,reg.line=FALSE,data=dat)
reg1=lm(y~x1+x2)
summary(reg1)
coef1=coef(reg1)
curve(coef1[1]+coef1[3]+coef1[2]*x,from=1500,to=10000,add=T,col="red")
curve(coef1[1]+coef1[2]*x,from=1500,to=10000,add=T)
scatterplot(y~x1|x2,smooth=FALSE,reg.line=lm,data=dat)
scatterplot(y~x1|x2,smooth=FALSE,reg.line=FALSE,data=dat)
reg1=lm(y~x1+x2)
summary(reg1)
scatterplot(y~x1|x2,smooth=FALSE,reg.line=lm,data=dat)
scatterplot(y~x1,smooth=FALSE,reg.line=lm,data=dat)
scatterplot(y~x1|x2,smooth=FALSE,reg.line=lm,data=dat)
reg2=lm(y~x1+x2+x1:x2) #same as lm(y~x1+x2+x1*x2) or lm(y~x1*x2)
scatterplot(y~x1|x2,smooth=FALSE,reg.line=FALSE,data=dat)
help("scatterplot")
scatterplot(y~x1|x2,smooth=FALSE,regLine=FALSE,data=dat)
vc=vcov(reg2);round(vc,2)
